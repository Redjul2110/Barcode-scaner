import cv2
from pyzbar.pyzbar import decode

def main():
    cap = cv2.VideoCapture(0)
    print("Starte Barcode-Scan. Dr√ºcke 'q' zum Beenden.")
    while True:
        ret, frame = cap.read()
        if not ret:
            break

        for barcode in decode(frame):
            barcode_data = barcode.data.decode('utf-8')
            barcode_type = barcode.type
            print(f"Gefundener Barcode: {barcode_data} (Typ: {barcode_type})")
            # Zeichne Rechteck um Barcode
            pts = barcode.polygon
            pts = [(pt.x, pt.y) for pt in pts]
            cv2.polylines(frame, [np.array(pts)], True, (255, 0, 0), 3)
            cv2.putText(frame, barcode_data, (pts[0][0], pts[0][1]-10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0,255,0), 2)

        cv2.imshow('Barcode Scanner', frame)
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

    cap.release()
    cv2.destroyAllWindows()

if __name__ == '__main__':
    main()